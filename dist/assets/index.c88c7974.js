import{K as w,d as _,M as E,i as D,_ as V,r as s,o as v,m as B,w as r,b as t,j as $,P as k,A as S,S as A,B as L,c as U,a as F,e as b,t as y,C as q,H as N,E as G}from"./index.8250fede.js";import{a as j,u as z,T as O}from"./table.c1136bd1.js";function P(e){return w({url:"/log/list",method:"post",baseURL:"/mock",data:e})}function I(e){return w({url:"/log/del",method:"post",baseURL:"/mock",data:e})}const J=_({components:{Layer:E},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){let n=D({name:"",charger:"",status:1,remark:""});const p={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],slug:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",trigger:"blur"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001",trigger:"change"}],remark:[{required:!1,message:"\u8BF7\u8F93\u5165\u5907\u6CE8",trigger:"blur"}]};function m(){e.layer.row&&(n=JSON.parse(JSON.stringify(e.layer.row)))}return m(),{ruleForm:n,rules:p}},methods:{submit(){this.$refs.form.validate(e=>{if(e){let a=this.ruleForm;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){j(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.layer.show=!1,this.$emit("getTableData",!0)})},updateForm(e){z(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1)})}}});function M(e,a,n,p,m,h){const i=s("el-input"),u=s("el-form-item"),c=s("el-switch"),d=s("el-form"),g=s("Layer",!0);return v(),B(g,{layer:e.layer,onConfirm:e.submit},{default:r(()=>[t(d,{model:e.ruleForm,rules:e.rules,ref:"form","label-width":"120px",style:{"margin-right":"30px"}},{default:r(()=>[t(u,{label:"\u540D\u79F0\uFF1A",prop:"name"},{default:r(()=>[t(i,{modelValue:e.ruleForm.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.ruleForm.name=o),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u8D1F\u8D23\u4EBA\uFF1A",prop:"charger"},{default:r(()=>[t(i,{modelValue:e.ruleForm.charger,"onUpdate:modelValue":a[1]||(a[1]=o=>e.ruleForm.charger=o),placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u72B6\u6001\uFF1A",prop:"status"},{default:r(()=>[t(c,{modelValue:e.ruleForm.status,"onUpdate:modelValue":a[2]||(a[2]=o=>e.ruleForm.status=o),"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0,onChange:a[3]||(a[3]=o=>e.handleUpdateStatus(e.scope.row))},null,8,["modelValue"])]),_:1}),t(u,{label:"\u5907\u6CE8\uFF1A",prop:"remark"},{default:r(()=>[t(i,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":a[4]||(a[4]=o=>e.ruleForm.remark=o),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u4FE1\u606F",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var R=V(J,[["render",M]]);const H=_({components:{Table:O,Layer:R},setup(){const e=D({input:""}),a=D({show:!1,title:"\u65B0\u589E",showButton:!0}),n=D({index:1,size:20,total:0}),p=$(!0),m=$([]),h=$([]),i=o=>{h.value=o},u=o=>{p.value=!0,o&&(n.index=1);let f={page:n.index,pageSize:n.size,...e};P(f).then(l=>{let C=l.data.list;C.forEach(T=>{T.loading=!1}),m.value=C,n.total=Number(l.data.pager.total)}).catch(l=>{m.value=[],n.index=1,n.total=0}).finally(()=>{p.value=!1})},c=o=>{let f={ids:o.map(l=>l.id).join(",")};I(f).then(l=>{G({type:"success",message:"\u5220\u9664\u6210\u529F"}),u(m.value.length===1)})},d=o=>{a.title="\u65B0\u589E\u89D2\u8272",a.show=!0,delete a.row},g=o=>{a.title="\u7F16\u8F91\u89D2\u8272",a.row=o,a.show=!0};return u(!0),{Plus:k,Delete:S,Search:A,query:e,tableData:m,chooseData:h,loading:p,page:n,layer:a,handleSelectionChange:i,getTableData:u,handleDel:c,handleAdd:d,handleEdit:g}}}),K={class:"layout-container"},Q={class:"layout-container-form flex space-between"},W={class:"layout-container-form-handle"},X={class:"layout-container-form-search"},Y={class:"layout-container-table"};function Z(e,a,n,p,m,h){const i=s("el-button"),u=s("el-popconfirm"),c=s("el-input"),d=s("el-table-column"),g=s("Table"),o=s("Layer"),f=L("loading");return v(),U("div",K,[F("div",Q,[F("div",W,[t(i,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:r(()=>[b(y(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),t(u,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=l=>e.handleDel(e.chooseData))},{reference:r(()=>[t(i,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:r(()=>[b(y(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),F("div",X,[t(c,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=l=>e.query.input=l),placeholder:e.$t("message.common.searchTip")},null,8,["modelValue","placeholder"]),t(i,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[2]||(a[2]=l=>e.getTableData(!0))},{default:r(()=>[b(y(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),F("div",Y,[q((v(),B(g,{ref:"table",page:e.page,"onUpdate:page":a[3]||(a[3]=l=>e.page=l),showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:r(()=>[t(d,{prop:"operator",label:"\u64CD\u4F5C\u4EBA",align:"center"}),t(d,{prop:"content",label:"\u64CD\u4F5C\u5185\u5BB9",align:"center"}),t(d,{prop:"operateDate",label:"\u64CD\u4F5C\u65F6\u95F4",align:"center"}),t(d,{prop:"ip",label:"ip",align:"center"}),t(d,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"280"},{default:r(l=>[t(u,{title:e.$t("message.common.delTip"),onConfirm:C=>e.handleDel([l.row])},{reference:r(()=>[t(i,{type:"danger"},{default:r(()=>[b(y(e.$t("message.common.del")),1)]),_:1})]),_:1},8,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[f,e.loading]]),e.layer.show?(v(),B(o,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):N("",!0)])])}var ae=V(H,[["render",Z],["__scopeId","data-v-73aa8d0a"]]);export{ae as default};
