import{K as C,d as k,M as T,i as D,_ as E,r as i,o as _,m as B,w as r,b as t,j as w,P as U,A,S as L,B as N,c as q,a as F,e as v,t as y,C as G,H as j,E as $}from"./index.8250fede.js";import{a as z,u as O,T as P}from"./table.c1136bd1.js";function R(e){return C({url:"/system/depart/list",method:"post",baseURL:"/mock",data:e})}function I(e){return C({url:"/system/depart/updateStatus",method:"post",baseURL:"/mock",data:e})}function J(e){return C({url:"/system/depart/del",method:"post",baseURL:"/mock",data:e})}const M=k({components:{Layer:T},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){let s=D({name:"",charger:"",status:1,remark:""});const g={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],slug:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",trigger:"blur"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001",trigger:"change"}],remark:[{required:!1,message:"\u8BF7\u8F93\u5165\u5907\u6CE8",trigger:"blur"}]};function c(){e.layer.row&&(s=JSON.parse(JSON.stringify(e.layer.row)))}return c(),{ruleForm:s,rules:g}},methods:{submit(){this.$refs.form.validate(e=>{if(e){let a=this.ruleForm;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){z(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.layer.show=!1,this.$emit("getTableData",!0)})},updateForm(e){O(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1)})}}});function H(e,a,s,g,c,b){const d=i("el-input"),m=i("el-form-item"),p=i("el-switch"),h=i("el-form"),f=i("Layer",!0);return _(),B(f,{layer:e.layer,onConfirm:e.submit},{default:r(()=>[t(h,{model:e.ruleForm,rules:e.rules,ref:"form","label-width":"120px",style:{"margin-right":"30px"}},{default:r(()=>[t(m,{label:"\u540D\u79F0\uFF1A",prop:"name"},{default:r(()=>[t(d,{modelValue:e.ruleForm.name,"onUpdate:modelValue":a[0]||(a[0]=n=>e.ruleForm.name=n),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(m,{label:"\u8D1F\u8D23\u4EBA\uFF1A",prop:"charger"},{default:r(()=>[t(d,{modelValue:e.ruleForm.charger,"onUpdate:modelValue":a[1]||(a[1]=n=>e.ruleForm.charger=n),placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA"},null,8,["modelValue"])]),_:1}),t(m,{label:"\u72B6\u6001\uFF1A",prop:"status"},{default:r(()=>[t(p,{modelValue:e.ruleForm.status,"onUpdate:modelValue":a[2]||(a[2]=n=>e.ruleForm.status=n),"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0,onChange:a[3]||(a[3]=n=>e.handleUpdateStatus(e.scope.row))},null,8,["modelValue"])]),_:1}),t(m,{label:"\u5907\u6CE8\uFF1A",prop:"remark"},{default:r(()=>[t(d,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":a[4]||(a[4]=n=>e.ruleForm.remark=n),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u4FE1\u606F",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var K=E(M,[["render",H]]);const Q=k({components:{Table:P,Layer:K},setup(){const e=D({input:""}),a=D({show:!1,title:"\u65B0\u589E",showButton:!0}),s=D({index:1,size:20,total:0}),g=w(!0),c=w([]),b=w([]),d=o=>{b.value=o},m=o=>{g.value=!0,o&&(s.index=1);let l={page:s.index,pageSize:s.size,...e};R(l).then(u=>{let V=u.data.list;V.forEach(S=>{S.loading=!1}),c.value=V,s.total=Number(u.data.pager.total)}).catch(u=>{c.value=[],s.index=1,s.total=0}).finally(()=>{g.value=!1})},p=o=>{let l={ids:o.map(u=>u.id).join(",")};J(l).then(u=>{$({type:"success",message:"\u5220\u9664\u6210\u529F"}),m(c.value.length===1)})},h=o=>{a.title="\u65B0\u589E\u89D2\u8272",a.show=!0,delete a.row},f=o=>{a.title="\u7F16\u8F91\u89D2\u8272",a.row=o,a.show=!0},n=o=>{if(!o.id)return;o.loading=!0;let l={id:o.id,status:o.status};I(l).then(u=>{$({type:"success",message:"\u72B6\u6001\u53D8\u66F4\u6210\u529F"})}).catch(u=>{$({type:"error",message:"\u72B6\u6001\u53D8\u66F4\u5931\u8D25"})}).finally(()=>{o.loading=!1})};return m(!0),{Plus:U,Delete:A,Search:L,query:e,tableData:c,chooseData:b,loading:g,page:s,layer:a,handleSelectionChange:d,getTableData:m,handleDel:p,handleAdd:h,handleEdit:f,handleUpdateStatus:n}}}),W={class:"layout-container"},X={class:"layout-container-form flex space-between"},Y={class:"layout-container-form-handle"},Z={class:"layout-container-form-search"},x={class:"layout-container-table"},ee={class:"statusName"};function ae(e,a,s,g,c,b){const d=i("el-button"),m=i("el-input"),p=i("el-table-column"),h=i("el-switch"),f=i("Table"),n=i("Layer"),o=N("loading");return _(),q("div",W,[F("div",X,[F("div",Y,[t(d,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:r(()=>[v(y(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"])]),F("div",Z,[t(m,{modelValue:e.query.input,"onUpdate:modelValue":a[0]||(a[0]=l=>e.query.input=l),placeholder:e.$t("message.common.searchTip")},null,8,["modelValue","placeholder"]),t(d,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[1]||(a[1]=l=>e.getTableData(!0))},{default:r(()=>[v(y(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),F("div",x,[G((_(),B(f,{ref:"table","row-key":"id",page:e.page,"onUpdate:page":a[2]||(a[2]=l=>e.page=l),showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:r(()=>[t(p,{label:"",align:"center",width:"20"}),t(p,{prop:"name",label:"\u540D\u79F0",align:"center"}),t(p,{prop:"status",label:"\u72B6\u6001",align:"center"},{default:r(l=>[F("span",ee,y(l.row.status===1?"\u542F\u7528":"\u7981\u7528"),1),t(h,{modelValue:l.row.status,"onUpdate:modelValue":u=>l.row.status=u,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0,loading:l.row.loading,onChange:u=>e.handleUpdateStatus(l.row)},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),_:1}),t(p,{prop:"charger",label:"\u8D1F\u8D23\u4EBA",align:"center"}),t(p,{prop:"remark",label:"\u5907\u6CE8",align:"center"}),t(p,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"280"},{default:r(l=>[t(d,{onClick:u=>e.handleEdit(l.row)},{default:r(()=>[v(y(e.$t("message.common.update")),1)]),_:1},8,["onClick"]),t(d,{type:"success",onClick:u=>e.handleAdd(l.row)},{default:r(()=>[v(y(e.$t("message.common.add")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[o,e.loading]]),e.layer.show?(_(),B(n,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):j("",!0)])])}var oe=E(Q,[["render",ae],["__scopeId","data-v-6ace59d6"]]);export{oe as default};
